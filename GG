<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wildcat Winter Jeopardy</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;700&family=Afacad+Flux:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        :root {
            --primary: #4f46e5; /* Indigo 600 */
            --secondary: #c084fc; /* Purple 400 */
            --accent: #fbbf24; /* Amber 400 */
            --bg-dark: #1e1b4b; /* Deep Indigo */
            --card-bg: #312e81; /* Indigo 800 */
            --text-light: #e0e7ff; /* Indigo 100 */
            --success: #22c55e; /* Green 500 */
            --danger: #ef4444; /* Red 500 */
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: 'Afacad Flux', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-light);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* --- SETUP SCREEN --- */
        #setup-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }

        h1 {
            font-family: 'Comfortaa', cursive;
            font-size: clamp(36px, 8vw, 60px);
            color: var(--secondary);
            margin-bottom: 10px;
            text-shadow: 0 4px 0 rgba(0,0,0,0.3);
            text-align: center;
        }

        .btn-group {
            display: flex;
            gap: 20px;
            margin: 30px;
        }

        .btn {
            padding: 15px 30px;
            font-family: 'Comfortaa', sans-serif;
            font-size: 24px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.1s, box-shadow 0.1s;
            background: var(--primary);
            color: white;
            box-shadow: 0 6px 0 #312e81;
        }

        .btn:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #312e81;
        }

        .btn-secondary {
            background: #64748b;
            box-shadow: 0 6px 0 #334155;
        }
        .btn-secondary:active { box-shadow: 0 2px 0 #334155; }

        .team-count-btn {
            width: clamp(60px, 12vw, 80px); 
            height: clamp(60px, 12vw, 80px);
            border-radius: 50%;
            font-size: clamp(24px, 6vw, 32px);
            display: flex; align-items: center; justify-content: center;
            background: white; color: var(--bg-dark);
            box-shadow: 0 6px 0 #cbd5e1;
        }
        .team-count-btn.selected {
            background: var(--accent);
            color: #451a03;
            box-shadow: 0 6px 0 #b45309;
            transform: scale(1.1);
        }
        .team-count-btn:active {
            transform: translateY(4px) scale(1.05);
            box-shadow: 0 2px 0 #b45309;
        }

        /* --- MAIN BOARD --- */
        #game-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            padding: 20px;
            max-width: 1600px;
            margin: 0 auto;
            width: 100%;
        }

        /* HEADER */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 0 10px;
        }
        header div {
            font-size: clamp(20px, 4vw, 30px);
        }

        /* GRID */
        #board {
            display: grid;
            grid-template-columns: repeat(5, 1fr); /* 5 Categories */
            grid-template-rows: auto repeat(5, 1fr); /* Header + 5 values */
            gap: 10px; /* Reduced gap for mobile */
            flex-grow: 1;
        }

        @media (min-width: 768px) {
            #board {
                gap: 15px;
            }
        }


        .category-header {
            background: var(--primary);
            color: white;
            font-family: 'Comfortaa', cursive;
            font-weight: 700;
            font-size: clamp(14px, 3vw, 24px);
            text-align: center;
            padding: 10px 5px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            border: 2px solid #6366f1;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }

        .tile {
            background: var(--card-bg);
            color: var(--accent);
            font-family: 'Comfortaa', cursive;
            font-size: clamp(24px, 5vw, 40px);
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid #4338ca;
            box-shadow: 0 4px 0 #1e1b4b;
        }

        .tile:hover {
            background: #4338ca;
            transform: translateY(-2px);
            box-shadow: 0 6px 0 #1e1b4b;
        }

        .tile:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #1e1b4b;
        }

        .tile.played {
            background: #1e1b4b; /* Dark/Empty */
            color: transparent;
            cursor: default;
            border: 2px solid #312e81;
            box-shadow: none;
            pointer-events: none;
        }

        /* SCOREBOARD */
        #scoreboard {
            display: flex;
            justify-content: space-around;
            background: rgba(0,0,0,0.3);
            padding: 15px 5px;
            border-radius: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .team-score {
            text-align: center;
            padding: 8px 15px;
            background: var(--card-bg);
            border-radius: 10px;
            border: 2px solid #4338ca;
            min-width: 100px;
            flex-grow: 1;
        }

        @media (min-width: 768px) {
             .team-score {
                padding: 10px 30px;
                min-width: 150px;
                flex-grow: 0;
            }
        }

        .team-name {
            display: block;
            font-size: clamp(14px, 3vw, 18px);
            color: #94a3b8;
            margin-bottom: 5px;
            font-family: 'Comfortaa';
        }

        .score-value {
            font-size: clamp(24px, 5vw, 32px);
            font-weight: 700;
            color: white;
        }

        /* --- QUESTION MODAL --- */
        #modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(15, 23, 42, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 50;
            backdrop-filter: blur(10px);
            padding: 20px;
        }

        .question-card {
            background: white;
            color: var(--bg-dark);
            width: 100%;
            max-width: 900px;
            height: 90%;
            max-height: 600px;
            border-radius: 20px;
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
            box-shadow: 0 0 50px rgba(79, 70, 229, 0.5);
            border: 5px solid var(--primary);
        }

        .modal-category {
            position: absolute;
            top: 0;
            background: var(--primary);
            color: white;
            padding: 10px 40px;
            border-radius: 0 0 20px 20px;
            font-family: 'Comfortaa';
            font-weight: bold;
            font-size: clamp(16px, 3vw, 20px);
        }

        .question-text {
            font-size: clamp(28px, 6vw, 48px);
            margin-bottom: 40px;
            line-height: 1.3;
            max-height: 60%;
            overflow-y: auto;
        }

        .answer-text {
            font-size: clamp(24px, 5vw, 36px);
            color: var(--success);
            font-weight: bold;
            margin-bottom: 40px;
            display: none; /* Hidden initially */
            max-height: 50%;
            overflow-y: auto;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            margin-top: auto;
            width: 100%;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* Award Points Buttons */
        .award-btn {
            display: none; /* Hidden until answer revealed */
            flex-direction: column;
            align-items: center;
            padding: 10px 15px;
            background: white;
            border: 2px solid #cbd5e1;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.1s;
        }
        .award-btn:hover { background: #f1f5f9; transform: scale(1.05); }
        .award-btn:active { transform: scale(1.0); }
        .award-btn strong { color: var(--primary); font-size: clamp(14px, 3vw, 18px); }
        .award-btn span { font-size: 14px; color: #64748b; display: none; } /* Hide span on small screens */

        @media (min-width: 768px) {
             .award-btn { padding: 15px 25px; }
             .award-btn span { display: block; }
        }

        .reveal-btn {
            background: var(--accent);
            color: #451a03;
            font-size: clamp(20px, 4vw, 24px);
            padding: 20px 40px;
            border: none;
            border-radius: 50px;
            font-family: 'Comfortaa';
            cursor: pointer;
            box-shadow: 0 6px 0 #b45309;
        }
        .reveal-btn:hover { transform: scale(1.05); }
        .reveal-btn:active { transform: translateY(4px); box-shadow: 0 2px 0 #b45309; }

        .close-btn {
            position: absolute;
            top: 20px; right: 20px;
            background: none; border: none;
            font-size: 30px; color: #94a3b8;
            cursor: pointer;
        }
        .close-btn:hover { color: var(--danger); }

    </style>
</head>
<body>

    <!-- SETUP SCREEN -->
    <div id="setup-screen">
        <h1>Wildcat Winter Jeopardy</h1>
        <p style="font-size: clamp(18px, 4vw, 24px); color: #a5b4fc; text-align: center;">How many teams are playing today?</p>
        
        <div class="btn-group">
            <button class="btn team-count-btn" onclick="selectTeamCount(2)">2</button>
            <button class="btn team-count-btn" onclick="selectTeamCount(3)">3</button>
            <button class="btn team-count-btn" onclick="selectTeamCount(4)">4</button>
        </div>

        <button class="btn" id="start-btn" onclick="startGame()" style="opacity: 0.5; pointer-events: none;">Start Game</button>
    </div>

    <!-- MAIN GAME -->
    <div id="game-container">
        <header>
            <div style="font-family: 'Comfortaa'; color: var(--text-light);"><i class="fa-solid fa-snowflake"></i> Winter Jeopardy</div>
            <button class="btn btn-secondary" onclick="resetGame()" style="font-size: 16px; padding: 10px 20px;">Reset Game</button>
        </header>

        <div id="board">
            <!-- Headers and Tiles Injected via JS -->
        </div>

        <div id="scoreboard">
            <!-- Scores Injected via JS -->
        </div>
    </div>

    <!-- QUESTION MODAL -->
    <div id="modal-overlay">
        <div class="question-card">
            <div class="modal-category" id="modal-cat-title">CATEGORY</div>
            <button class="close-btn" onclick="closeModal(false)"><i class="fa-solid fa-xmark"></i></button>
            
            <div class="question-text" id="modal-question">Question goes here...</div>
            <div class="answer-text" id="modal-answer">Answer goes here!</div>

            <button class="reveal-btn" id="reveal-btn" onclick="revealAnswer()">Show Answer</button>

            <div class="modal-actions" id="award-section">
                <!-- Award Buttons Injected via JS -->
            </div>
            
            <div id="no-winner-action" style="display:none; margin-top: 10px;">
                <button class="btn btn-secondary" onclick="closeModal(true)" style="background: transparent; border: 2px solid #94a3b8; color: #94a3b8; font-size: 16px;">No one got it</button>
            </div>
        </div>
    </div>

    <script>
        // --- GAME DATA ---
        const data = {
            categories: [
                "PRIDE Acronym",
                "Gear Up",
                "Hill Safety",
                "Snow Rules",
                "Wildcat Wisdom"
            ],
            questions: [
                // Cat 1: Acronym
                [
                    { q: "The 'P' in PRIDE stands for this.", a: "Positive" },
                    { q: "The 'R' in PRIDE stands for this.", a: "Respectful" },
                    { q: "The 'I' in PRIDE stands for this.", a: "Independent" },
                    { q: "The 'D' in PRIDE stands for this.", a: "Determined" },
                    { q: "The 'E' in PRIDE stands for this.", a: "Excellent Citizen" }
                ],
                // Cat 2: Gear
                [
                    { q: "You wear these on your hands to keep fingers warm.", a: "Gloves or Mittens" },
                    { q: "These keep your toes dry and warm.", a: "Snow Boots" },
                    { q: "This item covers your head to keep heat in.", a: "Hat" },
                    { q: "These cover your legs so your pants don't get wet.", a: "Snow Pants" },
                    { q: "You must do this to your coat before going outside.", a: "Zip it up!" }
                ],
                // Cat 3: Hill
                [
                    { q: "We never do this to others on the hill.", a: "Push or Shove" },
                    { q: "Instead of running on the hill, we should...", a: "Walk safely" },
                    { q: "Before sliding, you must wait for the person ahead to...", a: "Move away / Clear the bottom" },
                    { q: "How many people can slide at once?", a: "Only One" },
                    { q: "This might happen if you run on the ice.", a: "Slip and Fall" }
                ],
                // Cat 4: Snow Rules
                [
                    { q: "The number one rule about snowballs.", a: "NO Throwing Snowballs" },
                    { q: "We don't throw snowballs because this might be hiding inside.", a: "Ice" },
                    { q: "Instead of throwing snow, you can build this.", a: "A Snowman or Fort" },
                    { q: "If you see someone throwing snow, you should...", a: "Tell a teacher" },
                    { q: "Building a fort together shows this PRIDE trait.", a: "Respectful / Teamwork" }
                ],
                // Cat 5: Wisdom
                [
                    { q: "True or False: It is safe to cut in line for the hill.", a: "False" },
                    { q: "If you are cold, you should...", a: "Put on your gear (hat/gloves) or zip up" },
                    { q: "Being 'Independent' means keeping track of...", a: "Your own clothes/gear" },
                    { q: "An Excellent Citizen does this if a friend falls.", a: "Helps them up" },
                    { q: "The 'Golden Rule' of recess.", a: "Treat others how you want to be treated" }
                ]
            ]
        };

        // --- STATE ---
        let teamCount = 0;
        let scores = [];
        let currentQuestion = { c: 0, v: 0, value: 0 };
        
        // --- SETUP FUNCTIONS ---
        function selectTeamCount(n) {
            teamCount = n;
            // Remove 'selected' from all buttons
            document.querySelectorAll('.team-count-btn').forEach(b => b.classList.remove('selected'));
            
            // Add 'selected' to the clicked button
            if(event.currentTarget) {
                event.currentTarget.classList.add('selected');
            } else {
                 // Fallback for direct calls if event is not passed
                 document.querySelectorAll('.team-count-btn')[n-2].classList.add('selected');
            }
            
            const startBtn = document.getElementById('start-btn');
            startBtn.style.opacity = '1';
            startBtn.style.pointerEvents = 'auto';
        }

        function startGame() {
            if (teamCount === 0) {
                 // Simple alert replacement for critical error
                 const setupScreen = document.getElementById('setup-screen');
                 const errorMsg = document.createElement('p');
                 errorMsg.id = 'temp-error';
                 errorMsg.style.color = '#ef4444'; // FIX: Replaced invalid JS syntax var(--danger) with hex code
                 errorMsg.style.marginTop = '20px';
                 errorMsg.innerText = "Please select the number of teams first.";
                 
                 // Remove old error message if exists
                 const oldError = document.getElementById('temp-error');
                 if(oldError) oldError.remove();

                 setupScreen.appendChild(errorMsg);
                 return;
            }

            scores = new Array(teamCount).fill(0);
            renderBoard();
            renderScoreboard();
            document.getElementById('setup-screen').style.display = 'none';
        }

        function resetGame() {
            // Instead of confirm(), we just reload the page for a clean restart.
            if (window.confirm("Are you sure you want to reset the entire game?")) {
                location.reload();
            }
        }

        // --- RENDER FUNCTIONS ---
        function renderBoard() {
            const board = document.getElementById('board');
            board.innerHTML = '';

            // 1. Headers
            data.categories.forEach(cat => {
                const div = document.createElement('div');
                div.className = 'category-header';
                div.innerHTML = cat.replace(" ", "<br>");
                board.appendChild(div);
            });

            // 2. Tiles (Rows 100-500)
            const values = [100, 200, 300, 400, 500];
            
            for (let r = 0; r < 5; r++) { // 5 Rows (value index)
                for (let c = 0; c < 5; c++) { // 5 Columns (category index)
                    const val = values[r];
                    const tile = document.createElement('div');
                    tile.className = 'tile';
                    tile.id = `tile-${c}-${r}`;
                    tile.innerText = val;
                    // Pass the category index (c) and question index (r)
                    tile.onclick = (function(catIndex, qstIndex, value) {
                        return function() {
                            openQuestion(catIndex, qstIndex, value);
                        };
                    })(c, r, val);
                    board.appendChild(tile);
                }
            }
        }

        function renderScoreboard() {
            const sb = document.getElementById('scoreboard');
            sb.innerHTML = '';
            
            const colors = ['#ef4444', '#3b82f6', '#22c55e', '#f59e0b']; // Red, Blue, Green, Yellow
            const names = ['Red Team', 'Blue Team', 'Green Team', 'Yellow Team'];

            for(let i=0; i<teamCount; i++) {
                const div = document.createElement('div');
                div.className = 'team-score';
                div.style.borderColor = colors[i];
                
                div.innerHTML = `
                    <span class="team-name" style="color:${colors[i]}">${names[i]}</span>
                    <span class="score-value" id="score-${i}">0</span>
                `;
                sb.appendChild(div);
            }
        }

        function updateScoreDisplay() {
            for(let i=0; i<teamCount; i++) {
                document.getElementById(`score-${i}`).innerText = scores[i];
            }
        }

        // --- GAMEPLAY LOGIC ---
        function openQuestion(catIndex, valIndex, value) {
            const tile = document.getElementById(`tile-${catIndex}-${valIndex}`);
            if (tile.classList.contains('played')) return;

            currentQuestion = { c: catIndex, v: valIndex, value: value };

            // Populate Modal
            document.getElementById('modal-cat-title').innerText = data.categories[catIndex].toUpperCase() + ` ($${value})`;
            document.getElementById('modal-question').innerText = data.questions[catIndex][valIndex].q;
            document.getElementById('modal-answer').innerText = data.questions[catIndex][valIndex].a;
            
            // Reset Modal State
            document.getElementById('modal-answer').style.display = 'none';
            document.getElementById('reveal-btn').style.display = 'block';
            document.getElementById('award-section').style.display = 'none';
            document.getElementById('no-winner-action').style.display = 'none';
            
            // Generate Award Buttons
            const awardSec = document.getElementById('award-section');
            awardSec.innerHTML = '';
            const colors = ['#ef4444', '#3b82f6', '#22c55e', '#f59e0b'];
            const names = ['Red', 'Blue', 'Green', 'Yellow'];
            
            for(let i=0; i<teamCount; i++) {
                const btn = document.createElement('button');
                btn.className = 'award-btn';
                btn.onclick = () => awardPoints(i);
                btn.innerHTML = `
                    <i class="fa-solid fa-trophy" style="color: ${colors[i]}; font-size: 24px; margin-bottom: 5px;"></i>
                    <strong style="color: ${colors[i]}">${names[i]}</strong>
                    <span>(+${value})</span>
                `;
                awardSec.appendChild(btn);
            }

            document.getElementById('modal-overlay').style.display = 'flex';
        }

        function revealAnswer() {
            document.getElementById('reveal-btn').style.display = 'none';
            document.getElementById('modal-answer').style.display = 'block';
            
            // Show Award Buttons
            document.getElementById('award-section').style.display = 'flex';
            document.querySelectorAll('.award-btn').forEach(b => b.style.display = 'flex');
            document.getElementById('no-winner-action').style.display = 'block';
        }

        function awardPoints(teamIndex) {
            scores[teamIndex] += currentQuestion.value;
            updateScoreDisplay();
            closeModal(true);
        }

        function closeModal(wasAnswered) {
            if (wasAnswered) {
                const tile = document.getElementById(`tile-${currentQuestion.c}-${currentQuestion.v}`);
                if(tile) {
                    tile.classList.add('played');
                    tile.innerText = ""; // clear value
                }
            }
            document.getElementById('modal-overlay').style.display = 'none';
        }

        // Initialize game when the window loads if a team count was somehow preset (for testing/reloads)
        window.onload = function() {
            // Check if we are still on the setup screen or need to load the board
            if (document.getElementById('setup-screen').style.display !== 'none' && teamCount === 0) {
                // Default to 3 teams if testing outside the editor, otherwise stay on setup
                // For a good user experience, we ensure the setup screen is visible
            }
        };

    </script>
</body>
</html>
